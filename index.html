<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/aes.js"></script>
<script>
    var encrypted = CryptoJS.AES.encrypt("Message", "Secret Passphrase");

    var decrypted = CryptoJS.AES.decrypt(encrypted, "Secret Passphrase");
</script>

</head>
<script>
var ciphertext = "{\"ct\":\"f4VwPL+oUeBgmtEsj7DJHg==\",\"iv\":\"9dcbb609c8a4ad42ba48e01a436e76e6\",\"s\":\"d5d64726daf8b6cd\"}";

var JsonFormatter = {
        stringify: function (cipherParams) {
            // create json object with ciphertext
            var jsonObj = {
                ct: cipherParams.ciphertext.toString(CryptoJS.enc.Base64)
            };

            // optionally add iv and salt
            if (cipherParams.iv) {
                jsonObj.iv = cipherParams.iv.toString();
            }
            if (cipherParams.salt) {
                jsonObj.s = cipherParams.salt.toString();
            }

            // stringify json object
            return JSON.stringify(jsonObj);
        },

        parse: function (jsonStr) {
            // parse json string
            var jsonObj = JSON.parse(jsonStr);

            // extract ciphertext from json object, and create cipher params object
            var cipherParams = CryptoJS.lib.CipherParams.create({
                ciphertext: CryptoJS.enc.Base64.parse(jsonObj.ct)
            });

            // optionally extract iv and salt
            if (jsonObj.iv) {
                cipherParams.iv = CryptoJS.enc.Hex.parse(jsonObj.iv)
            }
            if (jsonObj.s) {
                cipherParams.salt = CryptoJS.enc.Hex.parse(jsonObj.s)
            }

            return cipherParams;
        }
    };

function decrypt() {
	var password = $("#password-div input[type=password]")[0].value;
	$("#password-div")[0].style.display = "none";
	var decrypted = CryptoJS.AES.decrypt(ciphertext,"pass",{format:JsonFormatter});
	document.body.appendChild(document.createTextNode(decrypted.toString(CryptoJS.enc.Utf8)));
	$("#save-div")[0].style.display = "block";
}

function encrypt(str) {
	CryptoJS.AES.encrypt(str,"pass",{format:JsonFormatter});
}
</script>
<style>
#save-div {
	display: none;
}
</style>
<body>
<div id="password-div">
<p>Enter password: <input type="password"> <input type="button" value="Decrypt" onclick="decrypt()"></p>
</div>
<div id="save-div">
<input type="button" value="Save">
</div>
</body>
</html>
